{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Project overview","text":""},{"location":"#what","title":"What","text":"<p>We are building a new typhoid immunity model with a continuous, time-varying correlate of protection and dose-dependent susceptibility.</p>"},{"location":"#why","title":"Why","text":"<p>Because typhoid immunity is interesting! The new Typhoid Conjugate Vaccine (TCV) seems to perform differently in different settings. Everywhere it's been trialed, the observed efficacy against blood-culture confirmed typhoid is around ~80% for the first two years, but while there is little evidence of waning in some settings \u2014 not yet reported in Nepal and statistically insignificant in Malawi \u2014 there is clear waning in Bangladesh and both lower observed efficacy and faster and city-dependent waning in Pakistan. In addition, there is some observed variation of waning by age, with younger children waning faster.</p> <p>These strong differences in vaccine effectiveness by setting and age indicate the need for bespoke vaccination strategies. To rationally design those strategies across settings \u2014 from hyper-endemic to solely at risk from importation \u2014 we need a model capable of explaining the observations and extrapolating from them.</p>"},{"location":"#how","title":"How","text":"<p>Prior work by IDM on poliovirus \u2014 another predominantly enteric pathogen transmitted via the fecal-oral route \u2014 found that epidemiological measures of immunity depend on both individual-level immune response and the typical size of pathogen doses acquired via transmission, and we built a model to capture that dynamic. Following the demonstration that a similar model framework was useful for COVID as well, we've developed a general formulation of the model and will be fitting it to typhoid for the first time in this project.</p> <p>We'll explain the model as we develop it using this blog and documentation. Until then, here are preview slides describing the approach. You can see that it is in the flavor of a PK/PD model common for drug development, but with some features I haven't seen implemented by others. For a technical introduction to PK/PD modeling, see these notes by Henrik Madsen).</p>"},{"location":"#when","title":"When","text":"<p>We hope to have useful results well before the WHO SAGE meeting on TCV schedule recommendations in October 2025. Initial deadline to de-risk the whole project is April 2025.</p>"},{"location":"#where","title":"Where","text":"<p>Developed at the Institute for Disease Modeling (IDM), a research institute within the Gates Foundation's Global Health Division.</p> <p>The Github repo is famulare/typhoid-immune-dynamics.</p>"},{"location":"#who","title":"Who","text":"<p>Technical project lead: Mike Famulare.</p> <p>Technical collaboration with: Kyra Grantz, Vince Buffalo, and Alicia Kraay.</p> <p>IDM Typhoid research and strategy lead: Jillian Gauld.</p>"},{"location":"about/","title":"About","text":"<p>This project is an experiment in open science and model development. We'll be live-blogging the process of building a new, state-of-the-art typhoid immune model for use in transmission modeling and vaccine schedule recommendations. Documentation will grow as the model stabilizes, and all code will be available in flight.</p> <p>Please follow along and don't hesitate to comment via github issues, or send me an email at mike-dot-famulare-at-gatesfoundation-dot-org.</p>"},{"location":"blog/","title":"Typhoid immune dynamics working notes","text":"<p>Blog to share musings, work in progress, etc to complement stand-alone Docs.</p>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/","title":"Intra-host Salmonella Typhi Model - scoping notes","text":"<p>Notes prepared from voice dictation with assistance of ChatGPT-4o.</p>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#scope","title":"Scope","text":"<p>These notes provide the skeleton of a model that aims to simulate within-host dynamics of Salmonella Typhi, connecting immune responses (especially antibody titers) to protection outcomes. It bridges vaccine efficacy and immunogenicity study field data and controlled human infection models (CHIM), and serves as the foundation for a next-generation Typhoid intrahost model suitable for generalizing across all exposure and immunological histories.</p> <p>Note that we may not ever build this model as it is beyond the scope of current vaccine schedule policy needs. However, it is essential to think through the whole problem to understand how to make incisive tactical simplifications of the science, the project scope, and deliverables.</p>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#core-model-ingredients","title":"Core Model Ingredients","text":""},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#1-immune-components","title":"1. Immune Components","text":"<ul> <li>Serum antibody titers from vaccination (e.g. anti-Vi IgG) or natural exposure (e.g. anti-hemolysin-E IgG).</li> <li>Potential mucosal or cellular immunity (to be abstracted, as likely not directly modelable since not measured).</li> <li>Waning of immunity over time.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#2-host-outcomes","title":"2. Host Outcomes","text":"<ul> <li>Probability of infection upon exposure.</li> <li>Probability of developing disease given infection.<ul> <li>Multiple levels of disease severity?</li> </ul> </li> <li>Probability of bacteremia given exposure</li> <li>Probablity of converse to carrier given exposure (likely mediated by bacteremia (+ host factors)). </li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#3-vaccination-and-exposure","title":"3. Vaccination and Exposure","text":"<ul> <li>Vaccine type, dose, and schedule.<ul> <li>Primary focus on Typbar-TCV (Vi-TT)</li> <li>also relevant is Vi-polysachharide, other conjugate VI (Vi-rEPA, non-Typbar Vi-TT)</li> <li>Non-Vi-based vaccine (Ty21a) probably well out of scope but may get \"for free\" with natural infection model</li> </ul> </li> <li>Time since vaccination or prior infection.</li> <li>Natural exposure characteristics (dose, infection frequency).</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#4-data-sources","title":"4. Data Sources","text":"<ul> <li>Field efficacy trials.</li> <li>Cross-study immunogenicity and serological datasets.</li> <li>Controlled Human Infection Model (CHIM) studies.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#key-complexities","title":"Key Complexities","text":""},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#1-mixed-immunological-histories","title":"1. Mixed Immunological Histories","text":"<ul> <li>Real-world individuals often have overlapping natural exposure and vaccine histories.</li> <li>Hard to isolate clean correlates of protection.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#2-data-harmonization","title":"2. Data Harmonization","text":"<ul> <li>Assay variability and inconsistent outcome definitions across studies.</li> <li>Need for preprocessing and standardization.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#3-multi-scale-integration","title":"3. Multi-scale Integration","text":"<ul> <li>Bridging within-host protection dynamics with population-level outcomes.</li> <li>Eventually feeding into stochastic cohort model and transmission model.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#4-parameter-identifiability","title":"4. Parameter Identifiability","text":"<ul> <li>Difficult to separate effects of different immune components from limited data.</li> <li>Identify data sources for each model component.<ul> <li>Current gap to be filled in: boosting.</li> <li>Nice to have: dose response vs immunity via challenge studies</li> </ul> </li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#5-model-parsimony-vs-fidelity","title":"5. Model Parsimony vs. Fidelity","text":"<ul> <li>A minimal model should balance simplicity (for calibration and communication) with enough biological realism to be meaningful and extensible.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#key-deliverables","title":"Key Deliverables","text":""},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#1-regression-model-prototype","title":"1. Regression Model Prototype","text":"<ul> <li>Goal: Connect antibody titers to vaccine efficacy.</li> <li>Scope: Exclude complexities such as mixed cohorts (e.g., vaccination and natural infection).</li> <li>Deadline: Thursday April 17, 2025.</li> <li>Output: A documented prototype, even if incomplete, embedded in the current modeling framework.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#2-data-aggregation-and-visualization","title":"2. Data Aggregation and Visualization","text":"<ul> <li>Goal: Collect and visualize immunogenicity and efficacy data from multiple studies.</li> <li>Status: First tangible deliverable to support model design and communication.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#3-calibration-harness","title":"3. Calibration harness","text":"<ul> <li>Goal: calibration framework that links data to be ingested with future model. Defines likelihood functions and model API interface requirements.</li> <li>Status: to be assigned.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#4-stochastic-cohort-simulation","title":"4. Stochastic Cohort Simulation","text":"<ul> <li>Goal: Build a simulation that captures variability in infection and protection at the population level.</li> <li>Timeline: Follows the completion of the regression model and calibration harness.</li> </ul>"},{"location":"blog/2025/04/09/intra-host-salmonella-typhi-model---scoping-notes/#5-integration-into-transmission-model","title":"5. Integration into transmission model","text":"<ul> <li>Goal: integrate immunity model into TyphoidSim member of the Starsim family. </li> </ul>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/","title":"A view over the horizon: cohort incidence model","text":"<p>After spending a lot of time with the primary literature on typhoid vaccine efficacy, correlates of protection, natural immunity, dose response from human challenge studies, seroepidemiology studies, and a lot of thinking, my manager Edward Wenger encouraged me to just do the thing. This script is the central artifact of that push.</p> <p>What? Implement the new intrahost immunity model in the context of a constant force-of-infection cohort model. Show that I can reproduce medium, high, and very high incidence archetypes being considered by a WHO-organized modeling consortium exercise. Other than the waning model, which was calibrated to organized and specific data with a simple log-least-squares approach all default parameters are currently hand-tuned by me, triangulating across various observations I\u2019ll try to summarize below.</p> <p>What did I learn? It works! The model can accomodate a bunch of non-trivial observations across a diversity of sources and settings. And, having the model prototype with a bunch of outputs has enabled a lot of rich back and forth with Kyra Grantz that\u2019s already making this model better and asking important questions of this new model, their current model, and other sources of data and inferences about how typhoid works.</p> <p>What\u2019s next? Put the model into Typhoidsim. Get serious about calibration and applying it to vaccine policy questions. Iterate on many science questions and additional model features around shedding.</p>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#outline","title":"Outline","text":"<p>In this script, I\u2019ll set up the immunity model and then embed it in a cohort model. I\u2019ll quickly document decisions and questions along the way, leaving breadcrumbs for better documentation and future iterations later on. After the setup, we\u2019ll take it for a spin and see a bunch of things it can do! Along the way, I\u2019ll leave notes about the contrasts with established models and problems or open questions with this one. Enjoy!</p>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#the-code","title":"The code","text":"<p>First, let\u2019s get some boilerplate out of the way and set up our environment.</p> <pre><code># imports\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggridges)\nlibrary(scales)\n\n# age width function\n# I use this later to re-extract age_group widths from a cut() call\nage_width = function(age_group,age_max){\n  round(as.numeric(as.character(fct_recode( age_group,\n                                            `2`='[0,2]',`3`='(2,5]',`5`='(5,10]',`5.1`='(10,15]',!!as.character(age_max-15):=paste('(15,',age_max,']',sep='')))))\n}\n</code></pre>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#intrahost-immunity-model-functions","title":"Intrahost immunity model functions","text":"<p>The immunity model uses anti-Vi IgG ELISA titers as a correlate of protection from infection and from fever, through the effect of immunity on susceptibility as a function of bacterial dose. It is based on the data described here and other references not yet documented (especially human challenge studies with data on shedding and disease).</p> <p>The titer response function describes the time dynamics of the correlate of protection (CoP). In this prototype, we assume no individual-level variation\u2014everyone has identical responses to identical exposures and initial conditions. The titer response rises over 30.4 days (conveniently a month for simulation purposes, but ~28 days to peak is probably ever so slightly more realistic.)</p> <p>By assumption, the initial unexposed baseline value of the correlate of protection is set to 1. The most common assay (VaccZyme Anti-Vi IgG) has a limit of detection (LOD) of 7 EU/ml, so I don\u2019t know the baseline for sure. But modeling the censoring seems to say 1 works pretty well and also I don\u2019t think it matters because of how the fold-rise model (to come) works. (Any lower number will get multiplied by a higher number above LOD and end up back in the observable range.) The peak CoP default is set to 1000 until otherwise specified by the fold-rise model. The long-time power-law exponent \u03b1, the reference short-time decay constant T<sub>decay</sub>, and the age-dependency coefficients on them are fit to titer data, to be explained another day. The initial rise parameters are all just picked to be about right/pretty because they have no effect on the rest of the model.</p> <pre><code># titer response function\ntiter_vs_time = function(t,age_years, CoP_peak=1000, CoP_pre=1,\n                         T_decay=11, alpha=1.16,\n                         beta_T_decay_age=0.057, beta_alpha_age=-0.060,\n                         CoP_min=1,T_rise=1.5,t_start=3,t_peak=30.4){\n\n  Tda = T_decay * exp(beta_T_decay_age * age_years)\n  ka = alpha * exp(beta_alpha_age * age_years)\n\n  # power law decay\n  titer = CoP_min + (CoP_peak-CoP_min)*(1+(t-t_peak)/(ka*Tda))^(-ka)\n\n  # simple logistic interpolator rise (this is just for continuity/realism. plays no role in the model)\n  titer[t&lt;t_peak ] =\n    CoP_pre + (CoP_peak-CoP_pre)*\n    (1/(1+exp(-(t[t&lt;t_peak] - t_start*5)/T_rise)) - 1/(1+exp(-(0-t_start*5)/T_rise)))/\n    (1/(1+exp(-(t_peak - t_start*5)/T_rise)) - 1/(1+exp(-(0-t_start*5)/T_rise)))\n\n  return(titer)\n}\n\nexpand.grid(t=seq(0,10,by=1/24), age_years = factor(c(1,5,15,45))) |&gt; \n  mutate(titer = titer_vs_time(t=t*365,age=as.numeric(age_years))) |&gt;\n  ggplot() +\n  geom_line(aes(x=t,y=titer,color=age_years)) + \n  theme_bw() + scale_y_continuous(trans='log10') + xlab('years post response') + ylab('')\n</code></pre> <p></p> <p>The fold-rise model describes the CoP response after an immunizing event, given the pre-challenge CoP. The default for CoP<sub>max</sub>, the maximum possible titer (discussed here) comes from an analysis of pre-post vaccine responses, and the default mu<sub>0</sub> parameter is set by a loosely informed guess from a model of pre-post infection dynamics and triangulating some vaccine study control groups, all to be explained another day.</p> <pre><code># fold-rise model. defaults set to natural immunity defaults\nfold_rise_model = function(CoP_pre,\n                           mu_0=2.5,\n                           CoP_max=10^3.5, CoP_min=1){\n  fold_rise = 10^(mu_0*(1-(log10(CoP_pre)-log10(CoP_min))/(log10(CoP_max)-log10(CoP_min))))\n  return(fold_rise)\n}\n\npl_df=expand.grid(CoP_pre=10^seq(0,3.5,by=0.1)) |&gt; \n  mutate(fold_rise = fold_rise_model(CoP_pre=CoP_pre)) |&gt;\n  mutate(CoP_post = fold_rise * CoP_pre) \n(ggplot(pl_df) +\n  geom_line(aes(x=CoP_pre,y=fold_rise)) +\n  theme_bw() + scale_y_continuous(trans='log10') + scale_x_continuous(trans='log10') +\n  xlab('pre-challenge titer') + ylab('fold-rise')) +\n  (ggplot(pl_df) +\n     geom_line(aes(x=CoP_pre,y=CoP_post)) +\n     theme_bw() + scale_y_continuous(trans='log10') + scale_x_continuous(trans='log10') +\n     xlab('pre-challenge titer') + ylab('post-challenge titer'))\n</code></pre> <p></p> <p>The fold-rise model combines with the titer vs.\u00a0time model to give the immune response over a lifetime of infection (in this case, or vaccination too but not shown here). As an example, here\u2019s an unlucky person infected on their 2nd birthday and again on their 7th.</p> <pre><code>data.frame(t=seq(0,15,by=1/12), titer=1) |&gt; \n  mutate(titer = if_else(t&lt;=2, titer, \n                         titer_vs_time(t=(t-2)*365,age=2,\n                                       CoP_pre=titer[t==2],\n                                       CoP_peak = titer[t==2]*fold_rise_model(CoP_pre = titer[t==2])))) |&gt;\n  mutate(titer = if_else(t&lt;=7, titer, \n                         titer_vs_time(t=(t-7)*365,age=7,\n                                       CoP_pre=titer[t==7],\n                                       CoP_peak = titer[t==7]*fold_rise_model(CoP_pre = titer[t==7])))) |&gt;\n  ggplot() +\n  geom_line(aes(x=t,y=titer)) + \n  theme_bw() + scale_y_continuous(trans='log10') + xlab('age [years]') + ylab('Anti-Vi IgG [EU/ml]')\n</code></pre> <p></p> <p>We care about titers because we use them as a correlate of protection. The evidence on typhoid supports that anti-Vi titers are a useful predictor, and we can encode the affect of prior immunity through that the the effect of dose, where it\u2019s known from challenge studies that higher doses are more likely to lead to stool-culture confirmed infection and fever.</p> <p>The dose-response model as a function of immunity and bacilli eaten is given below. It\u2019s informed by old challenge studies that measured it directly in cohorts without well-measured prior immunity, and more recent studies with naive adults. Parameters are hand-fiddled based on that an a bunch of other things included vaccines, all to be described another day.</p> <pre><code># dose response\np_outcome_given_dose = function(dose=1e4,  CoP_pre=1, outcome = 'fever_given_dose', \n                                n50_fever_given_dose=27800, alpha_fever_given_dose=0.84, \n                                gamma_fever_given_dose=0.4,\n                                n50_infection_given_dose=27800/10,alpha_infection_given_dose = 0.84*2, \n                                gamma_infection_given_dose=0.4/2 \n                                ){\n\n  if(outcome == 'fever_given_dose'){\n\n    p = 1 - (1+dose*(2^(1/alpha_fever_given_dose)-1)/n50_fever_given_dose)^(-alpha_fever_given_dose/(CoP_pre^gamma_fever_given_dose))\n\n  } else if (outcome == 'infection_given_dose'){\n\n    p = 1 - (1+dose*(2^(1/alpha_infection_given_dose)-1)/n50_infection_given_dose)^\n      (-alpha_infection_given_dose/(CoP_pre^gamma_infection_given_dose))\n\n  } else if (outcome == 'fever_given_infection'){\n\n    p = (1 - (1+dose*(2^(1/alpha_fever_given_dose)-1)/n50_fever_given_dose)^\n           (-alpha_fever_given_dose/(CoP_pre^gamma_fever_given_dose))) /\n      (1 - (1+dose*(2^(1/alpha_infection_given_dose)-1)/n50_infection_given_dose)^\n         (-alpha_infection_given_dose/(CoP_pre^gamma_infection_given_dose)))\n\n  }\n\n  return(p)\n}\n\nexpand.grid(dose = 10^seq(0,9,by=0.1),\n            CoP_pre = round(10^seq(0,3.5,by=0.5)),\n            outcome=factor(c('infection_given_dose','fever_given_dose'),\n                           levels=c('infection_given_dose','fever_given_dose','fever_given_infection'))) |&gt;\n  group_by(outcome,CoP_pre,dose) |&gt;\n  mutate(probability = p_outcome_given_dose(dose=dose,CoP_pre=CoP_pre,outcome = outcome)) |&gt;\n  mutate(CoP_pre = factor(CoP_pre)) |&gt;\n  ggplot() +\n  geom_line(aes(x=dose,y=probability,group=CoP_pre,color=CoP_pre)) +\n  facet_grid('~outcome') +\n  theme_bw() +\n  ylim(c(0,1)) +\n  scale_x_continuous(trans='log10', breaks=10^seq(0,10,by=2),minor_breaks = NULL,\n                     labels = trans_format(\"log10\", math_format(10^.x)) )\n</code></pre> <p></p> <p>The protective efficacy of prior infection (in this case, also vaccine efficacy more generally) is defined as the relative risk reduction in the outcome (either stool-culture confirmed infection or fever, but could be other things like seroresponse, bacteremia, and conversion to carrier status) for a person with a given level of immunity vs a person who has never been exposed.</p> <pre><code># protective efficacy vs CoP_pre\nprotective_efficacy = function(dose=1e4,  CoP_pre=1, outcome = 'fever_given_dose', CoP_control=1){\n  VE = 1 - p_outcome_given_dose(dose,CoP_pre=CoP_pre,outcome = outcome)/\n    p_outcome_given_dose(dose,CoP_pre=CoP_control,outcome = outcome)\n  return(VE)\n}\n\nexpand.grid(dose = 10^seq(0,8,by=0.1),\n            CoP_pre = round(10^seq(0,3.5,by=0.5)),\n            outcome=factor(c('infection_given_dose','fever_given_dose'),\n                           levels=c('infection_given_dose','fever_given_dose','fever_given_infection'))) |&gt;\n  group_by(outcome,CoP_pre,dose) |&gt;\n  mutate(protective_efficacy = protective_efficacy(dose=dose,CoP_pre=CoP_pre,outcome = outcome)) |&gt;\n  mutate(CoP_pre = factor(CoP_pre)) |&gt;\n  ggplot() +\n  geom_line(aes(x=dose,y=protective_efficacy,group=CoP_pre,color=CoP_pre)) +\n  facet_grid('~outcome') +\n  theme_bw() +\n  ylim(c(0,1)) +\n  scale_x_continuous(trans='log10', breaks=10^seq(0,10,by=2),minor_breaks = NULL,\n                     labels = scales::trans_format(\"log10\", math_format(10^.x)) )\n</code></pre> <p></p> <p>The really interesting thing about this kind of model is that it captures how high doses can overwhelm prior immunity and reduce efficacy. This effect is critical for typhoid epidemiology, where exposures can vary by a factor of 1000 or more across settings in time and place, but is missing from the standard logistic regression approaches to modeling efficacy vs CoP that are standard in vaccinology (and which this model reduces to in the low dose limit.)</p>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#cohort-incidence-model","title":"Cohort incidence model","text":"<p>To show what the model can do, I built a constant force of infection cohort model. This model is designed to demonstrate what individual susceptibility and immune response looks like over a lifetime, in fictional settings where the force of infection never changes. It isn\u2019t a full transmission model because this version of the model lacks bacterial shedding, transmission routes, and contacts between people. But, any transmission model that establishes these endemic equilibrium exposure rates would show the same cohort behavior for these variables.</p> <p>To make everything play nice for running the model and plotting later, I wrapped the whole thing in a function. So let\u2019s have some fun stepping through that function, in the literate programming style enabled by <code>knitr::spin</code> and a custom post-processing one-liner.</p> <p>First, we define the function and it\u2019s inputs.</p> <pre><code>cohort_model = function(exposure_dose,exposure_rate,\n                        N=1000,age_max=75,\n                        titer_dt=365/12, # monthly timesteps so I can assume infections last one timestep\n                        max_titer_id = 1000 # saving every titer above ~1000 gets really slow\n                        ){\n</code></pre> <p>The two variables that define the transmission ecology are the exposure dose and exposure rate. The exposure dose is the number of bacilli typically ingested when exposed in the setting. This could be drawn from a distribution, but we'll just assume it's a fixed value for now. The exposure rate is the Poisson rate for how often a person is exposed to an infectious dose. Together, through the dose response model, the exposure rate and dose determine how often people get infected. </p> <p>The other parameters are just basic simulation config stuff. How many people (default <code>N=1000</code>), what is the maximimum age in years (default <code>age_max = 75</code>), the timestep (default <code>titer_dt=365/12</code>= 1 month), and how many people will we track the full time history of the titer for (default 'max_titer_id=1000'; I suggest you keep this at this size regardless of the N, as this is the slowest part of the code), </p> <p>With the function header and parameters defined, we step into the code. First, we initialize the time bins and the containers for the simulation outputs. </p> <pre><code>  simulation_months = seq(0,age_max*12-1,by=1)\n\n  # titer tracker\n  titer_df = expand.grid(id=1:max_titer_id, \n                         month=simulation_months,\n                         titer=1) |&gt;\n    mutate(age_years=month/12,\n           age_group=cut(age_years,breaks=c(0,2,5,10,15,age_max),include.lowest = TRUE)) |&gt;\n    mutate(age_width = age_width(age_group,age_max))\n\n  # disease events tracker\n  events_list =  replicate(N, list(exposure_month = NULL, exposure_count=NULL,\n                                   infected = NULL, \n                                   fever = NULL), \n                           simplify = FALSE)\n</code></pre> <p>We also make one extra accounting for reality, which is that young children have less exposure to typhoid. Infants because they do not eat adult food, and toddlers because they tyically eat small and limited diets. This should probably be configurable as parameters, but I'm not gonna play with it in this script so I just hard coded that children up through 12 months of age have 10% the exposure of adults and children 1-2 years have 50%, by pure assumption.</p> <pre><code>  # age-dependent exposure rate, to account for kids under 2y having less exposure to food and sewage\n  exposure_rate_multiplier = c(rep(0.1,13),rep(0.5,12),rep(1,length(simulation_months)-25))\n</code></pre> <p>With that set up, we can expose everyone for their lifetimes and save the exposure event times.</p> <pre><code>  # expose\n  for (id in (1:N)){\n    tmp_exposed = rpois(length(exposure_rate_multiplier),exposure_rate*exposure_rate_multiplier)\n    events_list[[id]]$exposure_month = which(tmp_exposed&gt;0)\n    events_list[[id]]$exposure_count = tmp_exposed[events_list[[id]]$exposure_month]\n\n    # declare needed fields\n    events_list[[id]]$infected = rep(0, length(events_list[[id]]$exposure_month))\n    events_list[[id]]$fever = rep(0, length(events_list[[id]]$exposure_month))\n  }\n</code></pre> <p>Now that we know when everone is exposed, we can step through to find when they are infected, and after each infection, what their antibody titers are until the next infection. At each exposure, the probability of infection is determined by the dose and the current titer. At each infection, the current titer is boosted by the fold-rise model and between infections, it wanes with the waning model. </p> <pre><code>  # infect and titer\n  for (id in (1:N)){\n\n    # titer holder, initialized at CoP_min=1 from birth\n    tmp_titer =rep(1,length(simulation_months))\n\n    # for each exposed person\n    if (length(events_list[[id]]$exposure_month) &gt;0){\n      for (k in 1:length(events_list[[id]]$exposure_month)){\n\n        exposure_month = events_list[[id]]$exposure_month[k]\n\n        # calculate their infection probability in that timestep (which may have more than 1 exposure)\n        p_once = p_outcome_given_dose(dose=exposure_dose,CoP_pre=tmp_titer[exposure_month],\n                                      outcome='infection_given_dose')\n        p_inf = 1-(1-p_once)^events_list[[id]]$exposure_count[k]\n\n        if(runif(1)&gt;p_inf){\n          # if not infected, record not infected upon exposure\n          events_list[[id]]$infected[k] = 0\n          events_list[[id]]$fever[k]    = 0\n        } else {\n          # if infected\n\n          # update infection list\n          events_list[[id]]$infected[k]=1\n\n          # calculate probability they get a fever given infection\n          p_fever = p_outcome_given_dose(dose=exposure_dose,CoP_pre=tmp_titer[exposure_month],\n                                         outcome='fever_given_infection')\n\n          # update fever list\n          if (runif(n=1)&lt;=p_fever){\n            # if fever\n            events_list[[id]]$fever[k]=1\n          } else {\n            # if no fever\n            events_list[[id]]$fever[k]=0\n          }\n\n          # construct piecewise titer curve from current infection forward\n            titer_pre = tmp_titer[exposure_month]\n            titer_post = titer_pre * fold_rise_model(CoP_pre = titer_pre)\n\n            future_times = exposure_month:length(simulation_months)\n            future_times_from_new_infection = titer_dt*(simulation_months-exposure_month+1)[future_times]\n\n            # call titer function\n            tmp_titer[future_times] = titer_vs_time(t=future_times_from_new_infection,\n                                                    age_years = exposure_month/12,\n                                                    CoP_pre = titer_pre,\n                                                    CoP_peak= titer_post)\n\n          # round just because I don't need a bazillion digits\n          tmp_titer[exposure_month:length(tmp_titer)] = round(tmp_titer[exposure_month:length(tmp_titer)],2)\n        }\n\n      }\n\n      # only save titer traces if the subject id is &lt;= max_titer_id, because this is expensive.\n      if(id &lt;= max_titer_id){\n        idx = titer_df$id == id\n        titer_df$titer[idx] = tmp_titer\n      }\n    }\n  }\n</code></pre> <p>That takes us through the whole model! But events_list was kind of an ugly way to do things, when we couldn't a priori know how many exposure events would happen for each person. So let's tidy that up now into a nice dataframe and add infection events to the titer traces for plotting later. And return the outputs.</p> <pre><code>  # make the events_list into a nice data frame\n\n    # select all list elements (people) with at least one infection event\n    not_empty_idx = which(!sapply(events_list, function(x){ is_empty(x$exposure_month)}))\n\n    # challenge to the reader (and author): how does this work???\n    events_df = tibble(id = not_empty_idx, data = events_list[not_empty_idx]) |&gt;\n      unnest_wider(data) |&gt;\n      unnest_longer(c(exposure_month,exposure_count,infected,fever), keep_empty = TRUE) |&gt;\n      mutate(exposure_age=exposure_month/12,\n             age_group=cut(exposure_age,breaks=c(0,2,5,10,15,age_max),include.lowest = TRUE)) |&gt;\n      mutate(age_width=age_width(age_group,age_max)) |&gt;\n      group_by(id) |&gt;\n      mutate(infection_age = if_else(infected==1,exposure_age,NA)) |&gt;\n      mutate(fever_age = if_else(fever==1,exposure_age,NA)) |&gt;\n      mutate(infected = factor(infected),\n             fever = factor(fever)) |&gt;\n      mutate(outcome = interaction(infected,fever)) |&gt;\n      mutate(outcome = fct_recode(outcome,exposed='0.0',infected='1.0',fever='1.1')) |&gt;\n      mutate(outcome = factor(outcome,levels=c('exposed', 'infected', 'fever')))\n\n  # combine time of infection events with titers for plotting\n  titer_df = titer_df |&gt;\n    left_join(events_df |&gt; select(id,infection_age,infected,fever) |&gt; \n                drop_na(infected),by=join_by(id ==id, age_years == infection_age))\n\n  # return\n  return(list(titer_df=titer_df,\n              events_df=events_df,\n              config=data.frame(exposure_dose,exposure_rate,N,age_max,titer_dt)))\n\n}\n</code></pre>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#running-the-model","title":"Running the model","text":"<p>Now that we have a model, let\u2019s take it for a spin. With an eye towards supporting WHO SAGE in typhoid vaccine policy decisions (archival link), we hand-picked exposure rate and dose parameters to roughly mimic three composite archetypes for typhoid incidence. The \u201cmedium\u201d incidence setting is characterized by an all-ages annual incidence of typhoid fever less than 100 per 100k persons per year and a flat age distribution among after infancy. The \u201chigh\u201d and \u201cvery high\u201d incidence settings have similar age distributions that peak at young ages, but differ in overall incidence (100/100k &lt; \u201chigh\u201d &lt; 1000/100k vs.\u00a0$1000/100k &lt; \u201cvery high\u201d).</p> <pre><code># if the simulation output is saved, just use the cache. Otherwise, run the models.\nif (!file.exists('scratch/output_cache.RData')){\n  output=list()\n\n  # define setting ecology: exposure rate and dose\n\n    # N_cohort=2e4 # a lot faster for playing\n    N_cohort=1e6 # made huge to get good stats at lower incidence\n\n    # medium\n    output[['medium']] = cohort_model(exposure_dose = 5e2,\n                                      exposure_rate=1/(12*40), # per month\n                                      N=N_cohort)\n\n    # high\n    output[['high']] = cohort_model(exposure_dose = 5e3,\n                                    exposure_rate=1/(12*20), # per month\n                                    N=N_cohort/5)\n\n    # very high\n    output[['very_high']] = cohort_model(exposure_dose = 5e4,\n                                         exposure_rate=1/(12*20), # per month\n                                         N=N_cohort/10)\n\n    save(output,N,file='scratch/output_cache.RData')\n} else {\n  load(file='scratch/output_cache.RData')  \n}\n</code></pre> <p>And, for summarizing the results, let\u2019s calculate incidence per 100k people by age and overall from the events data, and include the total incidence archetype targets for reference.</p> <pre><code># calculate incidence\nfor (k in 1:length(output)){\n\n  N = output[[k]]$config$N\n\n  output[[k]]$incidence_vs_age =\n    output[[k]]$events_df |&gt; group_by(age_group) |&gt;\n    summarize(incidence_fever = sum(fever==1)/(N*unique(age_width))*1e5,\n              incidence_infection = sum(infected==1)/(N*unique(age_width))*1e5,\n              symptomatic_fraction = sum(fever==1,na.rm=TRUE)/sum(infected==1,na.rm=TRUE),\n              age_width = unique(age_width)) |&gt;\n    mutate(incidence_fever_overall = sum(incidence_fever*age_width/sum(age_width)),\n           incidence_infection_overall = sum(incidence_infection*age_width/sum(age_width)),\n           incidence_fever_target = incidence_fever_targets[names(output)[k]])\n}\n\n# incidence targets\nincidence_fever_targets = c(medium = 53,high=214,very_high=1255)\n</code></pre>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#results","title":"Results!","text":""},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#incidence-by-age-and-across-setting-archetypes","title":"Incidence by age and across setting archetypes","text":"<p>Now we make lots of plots. This first loop makes panels for each transmission setting and type of incidence we\u2019re currently interested in \u2013 fever, any infection (as determined by stool shedding), and the fraction of infections with fever. There\u2019s a bunch of ggplot stuff and I\u2019m sure I could make it less verbose but that\u2019s not the point\u2013this is model diagnostics in action.</p> <pre><code>p_incidence_fever=list()\np_incidence_infection=list()\np_symptomatic_fraction=list()\nfor (k in 1:length(output)){\n  p_incidence_fever[[k]]=ggplot(output[[k]]$incidence_vs_age) +\n    geom_bar(aes(x=age_group,y=incidence_fever),stat='identity') +\n    geom_hline(aes(yintercept=incidence_fever_overall[1]),linetype='solid') +\n    geom_hline(aes(yintercept=incidence_fever_target[1]),linetype='dashed') +\n    theme_bw() +\n    xlab('') +\n    ylab('annual incidence of fever per 100k') +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10))\n\n  p_incidence_infection[[k]]=ggplot(output[[k]]$incidence_vs_age) +\n    geom_bar(aes(x=age_group,y=incidence_infection),stat='identity') +\n    geom_hline(aes(yintercept=incidence_infection_overall[1]),linetype='solid') +\n    theme_bw() +\n    xlab('') +\n    ylab('annual incidence of infection per 100k') +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10))\n\n  p_symptomatic_fraction[[k]]=ggplot(output[[k]]$incidence_vs_age) +\n    geom_bar(aes(x=age_group,y=symptomatic_fraction),stat='identity') +\n    theme_bw() +\n    xlab('') +\n    ylab('symptomatic fraction') +\n    ylim(c(0,1)) +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10))\n}\n</code></pre> <p>First up, typhoid fever incidence.</p> <pre><code>wrap_plots(p_incidence_fever) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p> <p>To roughly match the setting targets, we find that the medium incidence setting corresponds to a characteristic typhoid dose of roughly 500 bacilli received once every 40 years on average. High and very high incidence correspond roughly to an exposure every 20 years, but with a characteristic dose of 5000 bacilli (high) or 50,000 bacilli (very high). Proper calibration to specific targets can refine these numbers, but they illustrate the general principle that typhoid fever incidence depends on exposure rates and doses, and vary by age as a consequence of the interaction of exposure and dose \u2013 the transmission ecology \u2013 with immunity acquired over time.</p> <p>For the next plot, we look at incidence of infection\u2013defined here as any stool shedding. We see that infection incidence varies by an order of magnitude from medium to high fever incidence settings, but that the difference between high and very high fever incidence doesn\u2019t require that much higher infection incidence. This makes sense as our hand-picked paramters to describe the high settings have the same average expoosure rate of once every twenty years.</p> <pre><code>wrap_plots(p_incidence_infection) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p> <p>Rather, we see that the bacilliary dose makes a big difference to the probability of fever given infection. Following from the dose response data that the model is based on, fever is more common with higher doses. Higher doses but not significatly higher exposure rates is our hypothesis for the difference in fever incidence without difference in age distribution.</p> <pre><code>wrap_plots(p_symptomatic_fraction) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#individual-level-model-diagnostics","title":"Individual-level model diagnostics","text":"<p>Let\u2019s take a look at some model internals that show us what individual life histories look like. The next figure shows some example exposure, infection, and fever event traces, where each row is a person an the x-axis is age.</p> <pre><code>p_exposure=list()\nfor (k in 1:length(output)){\n  p_exposure[[k]] = ggplot(output[[k]]$events_df |&gt; filter(id&lt;=40)) +\n                      geom_point(aes(x=exposure_age,color=outcome,y=id)) +\n                      theme_bw() +\n                      xlab('age') +\n      labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n              subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                    1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10)) +\n    scale_color_discrete(drop = FALSE)\n}\nwrap_plots(p_exposure) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p> <p>The exposure events are shown as points, with the color indicating the outcome of the exposure. The outcome is either \u201cexposed\u201d (no infection or fever), \u201cinfected\u201d (stool shedding but no fever), or \u201cfever\u201d (stool shedding and fever). The x-axis is age in years, and the y-axis is person id. We see that most people are exposed at least once, and that some people have multiple exposures, infections, and fevers.</p> <p>The next figure shows the same thing, but with the titer traces for each person. In the medium incidence setting, most people are never infected, whereas mulitple infection is common in the high and very high incidence settings. If you look closely, you can also see how the waning rate slows down with age, consistent with data from TCV trials.</p> <pre><code>p_titer_examples=list()\nfor (k in 1:length(output)){\n  p_titer_examples[[k]] = ggplot() +\n    geom_line(data=output[[k]]$titer_df |&gt; filter(id&lt;=20),aes(x=age_years,y=titer)) + \n    geom_point(data=output[[k]]$titer_df |&gt; filter(id&lt;=20) |&gt; filter(!is.na(infected)),\n               aes(x=age_years,y=titer,color=fever)) +\n    scale_y_continuous(trans='log10',limits=c(1,10^3.5)) +\n    facet_wrap('id') +\n    theme_bw() +\n    xlab('age') +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10))  +\n    scale_color_discrete(drop = FALSE)\n}\nwrap_plots(p_titer_examples) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#population-immunity","title":"Population immunity","text":"<p>This last figure block calculates the population-level anti-Vi IgG titers and protective efficacy by age, given the model outputs. It shows how the titer and protective efficacy change with age, and how they differ across the three incidence settings. The titer is calculated as the geometric mean titer (GMT) and median titer, with 95% and IQR confidence intervals. The protective efficacy is calculated as the median and IQR of the protective efficacy given dose, which is a function of the exposure dose and the titer.</p> <pre><code>p_titer_summary=list()\np_titer_density=list()\np_protective_efficacy_infection_summary=list()\np_protective_efficacy_fever_summary=list()\nfor (k in 1:length(output)){\n\n  exposure_dose = output[[k]]$config$exposure_dose\n\n  tmp_titer_summary =output[[k]]$titer_df |&gt;\n    mutate(protective_efficacy_infection = protective_efficacy(dose = exposure_dose,CoP_pre = titer, outcome='infection_given_dose')) |&gt;\n    mutate(protective_efficacy_fever = protective_efficacy(dose = exposure_dose,CoP_pre = titer, outcome='fever_given_dose')) |&gt;\n    group_by(age_years) |&gt;\n    summarize(titer_gmt = exp(mean(log(titer))),\n           titer_median = median(titer),\n           titer_upper_iqr = quantile(titer,probs=0.75),\n           titer_lower_iqr = quantile(titer,probs=0.25),\n           titer_upper_95 = quantile(titer,probs=0.975),\n           titer_lower_95 = quantile(titer,probs=0.025),\n           protective_efficacy_infection_median = median(protective_efficacy_infection),\n           protective_efficacy_infection_upper_iqr = quantile(protective_efficacy_infection,probs=0.75),\n           protective_efficacy_infection_lower_iqr = quantile(protective_efficacy_infection,probs=0.25),\n           protective_efficacy_infection_upper_95 = quantile(protective_efficacy_infection,probs=0.975),\n           protective_efficacy_infection_lower_95 = quantile(protective_efficacy_infection,probs=0.025),\n           protective_efficacy_fever_median = median(protective_efficacy_fever),\n           protective_efficacy_fever_upper_iqr = quantile(protective_efficacy_fever,probs=0.75),\n           protective_efficacy_fever_lower_iqr = quantile(protective_efficacy_fever,probs=0.25),\n           protective_efficacy_fever_upper_95 = quantile(protective_efficacy_fever,probs=0.975),\n           protective_efficacy_fever_lower_95 = quantile(protective_efficacy_fever,probs=0.025))\n\n  p_titer_summary[[k]] = ggplot(tmp_titer_summary) +\n    geom_ribbon(aes(x=age_years,ymin=titer_lower_95,ymax=titer_upper_95),alpha=0.2)+\n    geom_ribbon(aes(x=age_years,ymin=titer_lower_iqr,ymax=titer_upper_iqr),alpha=0.2)+\n    geom_line(aes(x=age_years,y=titer_median)) + \n    geom_line(aes(x=age_years,y=titer_gmt),linetype='dashed') + \n    scale_y_continuous(limits=c(1,10^3.5)) +\n    theme_bw() +\n    xlab('age') +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10)) +\n    ylab('anti-Vi IgG EU/ml')\n\np_protective_efficacy_infection_summary[[k]] = ggplot(tmp_titer_summary) +\n    geom_ribbon(aes(x=age_years,ymin=protective_efficacy_infection_lower_95,ymax=protective_efficacy_infection_upper_95),alpha=0.2)+\n    geom_ribbon(aes(x=age_years,ymin=protective_efficacy_infection_lower_iqr,ymax=protective_efficacy_infection_upper_iqr),alpha=0.2)+\n    geom_line(aes(x=age_years,y=protective_efficacy_infection_median)) + \n    scale_y_continuous(limits=c(0,1)) +\n    theme_bw() +\n    xlab('age') +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10)) +\n    ylab('protective efficacy against infection')\n\np_protective_efficacy_fever_summary[[k]] = ggplot(tmp_titer_summary) +\n    geom_ribbon(aes(x=age_years,ymin=protective_efficacy_fever_lower_95,ymax=protective_efficacy_fever_upper_95),alpha=0.2)+\n    geom_ribbon(aes(x=age_years,ymin=protective_efficacy_fever_lower_iqr,ymax=protective_efficacy_fever_upper_iqr),alpha=0.2)+\n    geom_line(aes(x=age_years,y=protective_efficacy_fever_median)) + \n    scale_y_continuous(limits=c(0,1)) +\n    theme_bw() +\n    xlab('age') +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10)) +\n    ylab('protective efficacy against fever')\n\n\n  sampled_titer_df = output[[k]]$titer_df |&gt;\n    group_by(age_group,id) |&gt;\n    slice_sample(n=1)\n  p_titer_density[[k]] = ggplot(sampled_titer_df) +\n    geom_density_ridges(aes(x=titer,y=age_group),scale=0.9,jittered_points = TRUE,bandwidth = 0.1) + \n    scale_x_continuous(trans='log10',limits=c(7,10^3.5)) +\n    theme_bw() + \n    xlab('titer, given above limit of detection') +\n    ylab('') +\n    labs(title = paste(sub('_',' ',names(output)[k]),' incidence',sep=''),\n         subtitle=paste('dose = ',output[[k]]$config$exposure_dose,' bacilli\\nmean years b/w exposures = ',\n                        1/(12*output[[k]]$config$exposure_rate),sep='')) +\n    theme(plot.title=element_text(size=10),plot.subtitle=element_text(size=8),\n          axis.title = element_text(size=10)) \n}\n</code></pre> <p>This first plot shows the titer distribution by age, and</p> <pre><code>wrap_plots(p_titer_summary) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p> <p>the second shows the distribution of individual-level protective efficacies against infection and fever given those titers.</p> <pre><code>wrap_plots(wrap_plots(p_protective_efficacy_fever_summary),wrap_plots(p_protective_efficacy_infection_summary),nrow=2) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p> <p>Across settings, we see that immunity gets higher with age due to intensity of exposure and infection number, and that people, perhaps non-intuitively, have the highest protective efficacy in the highest incidence settings. This shows how exposure can more than compensate immunity, and thus the population-level epidemiology is a result of both transmission ecology and individual-level traits. This last figure shows densities of randomly sampled titers for simulated people who are above the detection threshold of the VaccZyme anti-Vi IgG assay.</p> <pre><code>wrap_plots(p_titer_density) + plot_layout(guides = \"collect\",axes='collect')\n</code></pre> <p></p> <p>This last figure below shows densities by age from pre-vaccine time points in Bangladesh published in Quadri et al 2021. Visually, our model is consistent with this data in the high or very high incidence settings, as expected. </p>"},{"location":"blog/2025/04/25/a-view-over-the-horizon-cohort-incidence-model/#open-questions-for-model-development","title":"Open questions for model development","text":"<p>I\u2019m sure there\u2019s more to say, but the biggest open questions for model development are</p> <ol> <li>Infection is defined as stool-positive in this model. How common are     infections that trigger immune responses but are not detectable in     stool? Serosurveys indicate this is a thing (Aiemjoy et al     2022), and so we     should figure out an additional dose-response component to account     for it.</li> <li>Immunity also affects the amount shed given infection, and that is     important to transmission. For modeling immunity and susceptibility     only, the current model is complete (up to question 1 above). But in     a future update, we should close the loop.</li> <li>Related, carrier status is likely modulated via bacteremia, the     probability of which also depends on immunity. This is again of     interest for a future update.</li> </ol>"},{"location":"blog/2025/03/17/hand-rolling-empirical-bayes-estimation-of-a-hierarchical-model-to-learn-how-it-works/","title":"Hand rolling empirical Bayes estimation of a hierarchical model to learn how it works","text":"<p>This is a quick experiment to teach myself if I can just use full likelihood optimization to get well-behaved empirical Bayes estimate of both the trial-level random effects and the metastudy group-level hyperparameters in a mixed model.</p> <p>Why? Because proper statisticians say you aren\u2019t supposed to use a full likelihood to estimate random effects and hyperparameters because it\u2019s biased for the group-level variance components, but how much does it matter for model fitting metastudy applications?</p> <p>I care because I like to use simple optimizations when initially calibrating models on the kind of strange data types I get from papers when I don\u2019t have the individual-level data. I want to better understand when I can take shortcuts and still get decent statistical properties during model development. Then, if doing the stats better proves to be important, relative to other limitations of the model, we can do better later.</p> <p>Also, I use packages to do mixed-effects modeling all the time, but I\u2019ve never worked out a non-Gaussian example. That is not a morally-sustainable position.</p> <p>What? Compare full maximum likelihood (ML) estimate where I jointly optimize over the subject-level random effects and the group level hyperparameters, vs the restricted maximum likelihood (REML) estimate where I first optimize only over the hyperparamaters and then find an empirical Bayes estimate of the random effects given the hyperparameters. For the best tight description of the two algorithms that I\u2019ve found, see this documentation for Estimating Parameters in Linear Mixed-Effects Models from The Mathworks.</p> <p>What did I learn? WHELP, it looks full likelihood optimization is just fine, at least for this example, which is on a relevant scale for a vaccine model building metastudy. (Of order 10 trial arms, with of order 100 subjects per arm, and binary outcomes.) I also learned that it was easy to implement the REML approach in this example. So, if it\u2019s also easy on the real calibration problem to come, I\u2019ll probably just do that.</p> <p>To learn more, and very quickly, about what I\u2019m trying to do, here\u2019s a useful chat log with ChatGPT4.5 to go along with this.</p> <p>What am I looking for from you? I\u2019ve learned a lot of stats over the last 15 years, but I\u2019m not trained as a statistician and I\u2019m always learning more. Please comment if you see anything you\u2019d like to correct or expand upon. Also, let me know if this was useful to you. Thanks!</p> <p>Note about how this post was generated. This post was generated directly from the commented R script using the <code>knitr::spin</code> functionality of <code>rmarkdown::render</code>. This gives all the advantages of scripts and r-markdown, without the disadvantages. Check out this blog post by Dean Attali to learn more.</p>"},{"location":"blog/2025/03/17/hand-rolling-empirical-bayes-estimation-of-a-hierarchical-model-to-learn-how-it-works/#setting-up-the-study","title":"Setting up the study","text":"<p>First, we set up a study with 10 trial arms and 100 people measured per arm. The group level is the ensemble of trial arms, and the individuals in this exmaple are the trial arms. The observations for each trial arm are zero or one for the outcome, and each arm has a true probability of the outcome drawn from a beta distribution for the ensemble of studies. Note that this isn\u2019t set up as real vaccine efficacy measurement. I\u2019m just interested in looking at cohort parameter estimation for now. VE would be a transform on that, if the arms were labeled by treatment vs control.</p> <pre><code># set up the environment\nlibrary(tidyverse)\nlibrary(rmutil)\nlibrary(stats4)\nlibrary(knitr)\n\n# set seed for reproducibility. Comment out to run many examples to see that this example is representative.\nset.seed(100)\n\n##simulate binomial draws from a beta random-effects model\n# typical example of a metastudy, 10 trials, ~100 subjects per trial\nn_trials = 10 # don't change! I hard-coded 10 later for dumb reasons w/r/t variable names in stats4::mle that I didn't feel like debugging.\nn_subjects=100 # you can change this if you want.\n\n# set up the measurement-level data frame\nsubjects = expand_grid(ID=1:n_trials,rep = 1:n_subjects)\n\n## draw probability of positive for each ID from a beta distribution\n\n# rmutil::betabinomial parameterization\nm=0.3\ns=8\n\n# rbeta parameterization\nalpha=m*s\nbeta=s-alpha\n\n# add true trial-level outcome probality to the subject data\nsubjects = subjects |&gt; left_join(\n  data.frame(ID=1:n_trials,p=rbeta(n_trials,shape1=alpha,shape2=beta)))\n\n# draw binomial samples for each subject\nsubjects = subjects |&gt; cbind(\n  data.frame(response=rbinom(n=nrow(subjects),size=1,prob=subjects$p)))\n\n# collapse the measurement-level data into subject level data for fitting later\nobserved = subjects |&gt; group_by(ID,p) |&gt;\n            summarize(n_pos=sum(response),\n                      n_trials=n(),\n                      p_hat = n_pos/n_trials)\n\nobserved |&gt; kable()\n</code></pre> ID p n_pos n_trials p_hat 1 0.2134503 22 100 0.22 2 0.3254404 34 100 0.34 3 0.2853022 27 100 0.27 4 0.4947419 48 100 0.48 5 0.3225656 29 100 0.29 6 0.3637010 49 100 0.49 7 0.2012123 23 100 0.23 8 0.4527466 45 100 0.45 9 0.1662158 17 100 0.17 10 0.2363248 34 100 0.34"},{"location":"blog/2025/03/17/hand-rolling-empirical-bayes-estimation-of-a-hierarchical-model-to-learn-how-it-works/#parameter-inference-with-the-full-likelihood","title":"Parameter inference with the full likelihood","text":"<p>The first approach I\u2019m considering is maximum likelihood estimation of both the population-level hyperparameters and the trial-level outcome probabilities. We can estimate both the MLE and the Wald confidence intervals from the variance-covariance matrix using <code>stats4::mle</code>. In the code chunk below, I define the likelihood function, run the optimization (using <code>method = 'L-BFGS-B</code> with appropriate bounds to respect parameter domains), and tidy up the results for display and plotting later.</p> <pre><code># define the negative log likelihood for the fully parameterized model: beta-distributed population + individial binomial probabilities\n# Note that I'm hardcoding data for this demo so I don't have to worry about passing data to mle later. This is for convenience.\nminus_log_lik = function(m=alpha/(alpha+beta),s=(alpha+beta),\n                         p1=observed$p[1],p2=observed$p[2],p3=observed$p[3],p4=observed$p[4], # there's surely a nicer way to do this...\n                         p5=observed$p[5],p6=observed$p[6],p7=observed$p[7],p8=observed$p[8],\n                         p9=observed$p[9],p10=observed$p[10]){\n  a = m*s\n  b = s-a\n  p =c(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10)\n\n  -sum(dbeta(x=p,shape1=a,shape2=b,log=TRUE) + dbinom(x=observed$n_pos,size=observed$n_trials,prob=p,log=TRUE))\n} \nminus_log_lik()\n\n# find the maximum likelihood estimate simulateously for both the trial-level random effects and the hyperparameters.\nmodel_lik = stats4::mle(minus_log_lik, start = list(m=0.5,s=10,p1=0.5,p2=0.5,p3=0.5,p4=0.5,\n                                                    p5=0.5,p6=0.5,p7=0.5,p8=0.5,p9=0.5,p10=0.5),\n                        method='L-BFGS-B',\n                        upper=c(0.99999,Inf,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999),\n                        lower=c(0.00001,0,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001))\nsummary(model_lik)\n\n# tidy up the results for display and later plotting\nfull_lik_params = data.frame(true=c(m=m,s=s,observed$p), estimate =coef(model_lik),  se = sqrt(diag(vcov(model_lik )))) |&gt;\n  mutate( z = (true-estimate)^2/se^2,\n          lower = estimate - 1.96*se, # wald confidence interval\n          upper = estimate + 1.96*se) |&gt;\n  rownames_to_column(var='param') |&gt;\n  select(param, everything()) |&gt; \n  mutate(param=factor(param,levels=c('m','s','p1','p2','p3','p4','p5','p6','p7','p8','p9','p10'))) |&gt;\n  mutate(level=factor(c('group_mean','group_dispersion',rep('trial',10)))) |&gt;\n  mutate(param_index = 1:12)\n\nfull_lik_params\n\n##    param      true   estimate          se          z      lower      upper            level param_index\n## 1      m 0.3000000  0.3246235  0.02967484 0.68853213  0.2664609  0.3827862       group_mean           1\n## 2      s 8.0000000 32.0202634 19.93898104 1.45127465 -7.0601394 71.1006663 group_dispersion           2\n## 3     p1 0.2134503  0.2414595  0.04012803 0.48719936  0.1628086  0.3201105            trial           3\n## 4     p2 0.3254404  0.3337523  0.04203733 0.03909562  0.2513592  0.4161455            trial           4\n## 5     p3 0.2853022  0.2799146  0.04053223 0.01766756  0.2004715  0.3593578            trial           5\n## 6     p4 0.4947419  0.4414270  0.04786335 1.24076659  0.3476149  0.5352392            trial           6\n## 7     p5 0.3225656  0.2952969  0.04085350 0.44552396  0.2152241  0.3753698            trial           7\n## 8     p6 0.3637010  0.4491181  0.04839787 3.11484948  0.3542583  0.5439780            trial           8\n## 9     p7 0.2012123  0.2491503  0.04016259 1.42467515  0.1704316  0.3278690            trial           9\n## 10    p8 0.4527466  0.4183538  0.04634406 0.55074260  0.3275194  0.5091881            trial          10\n## 11    p9 0.1662158  0.2030039  0.04030446 0.83312302  0.1240072  0.2820006            trial          11\n## 12   p10 0.2363248  0.3337523  0.04203733 5.37146452  0.2513592  0.4161455            trial          12\n</code></pre>"},{"location":"blog/2025/03/17/hand-rolling-empirical-bayes-estimation-of-a-hierarchical-model-to-learn-how-it-works/#parameter-inference-with-reml-and-empirical-bayes","title":"Parameter inference with REML and empirical Bayes","text":"<p>Before looking to closely at the results, let\u2019s look at the other (statistician-preferred) approach of estimating the hyperparameters first with the trial-level random effects integrated out, and then estimating the trial-level random effects given the hyperparameter MLEs.</p> <p>For the beta-binomial model, the restricted likelihood is just the analytic betabinomial distribution, which I wrap into a negative log likelhood for fitting.</p> <pre><code># hyperparameter likelihood\nminus_log_REML = function(m=alpha/(alpha+beta),s=(alpha+beta)){\n  -sum(rmutil::dbetabinom(y=observed$n_pos,size=observed$n_trials,m=m,s=s,log=TRUE))\n}\nminus_log_REML()\n\n# hyperparameter MLE\nmodel_REML = stats4::mle(minus_log_REML, start = list(m=0.5,s=1),\n            method='L-BFGS-B',\n            upper=c(0.99999,Inf),\n            lower=c(0.00001,0))\n\nsummary(model_REML)\n</code></pre> <p>Next, given the MLEs for the hyperparameters, I estimate the trial-level outcome probabilities and tidy up all the results.</p> <pre><code># empirical Bayes likelihood for the individual-level random effects. Plug in MLE of the hyperparameters.\nminus_log_REML_p = function(p1=observed$p[1],p2=observed$p[2],p3=observed$p[3],p4=observed$p[4], # there's probably a nicer way to do this...\n                            p5=observed$p[5],p6=observed$p[6],p7=observed$p[7],p8=observed$p[8],\n                            p9=observed$p[9],p10=observed$p[10]){\n\n  a = coef(model_REML)[1]*coef(model_REML)[2]\n  b = coef(model_REML)[2]-a\n  p =c(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10)\n\n  -sum(dbeta(x=p,shape1=a,shape2=b,log=TRUE) + dbinom(x=observed$n_pos,size=observed$n_trials,prob=p,log=TRUE))\n\n}\nminus_log_REML_p()\n\n# estimate the trial-level probabilities\nmodel_REML_p = stats4::mle(minus_log_REML_p, start = list(p1=0.5,p2=0.5,p3=0.5,p4=0.5,\n                                                        p5=0.5,p6=0.5,p7=0.5,p8=0.5,p9=0.5,p10=0.5),\n                         method='L-BFGS-B',\n                         upper=c(0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999,0.99999),\n                         lower=c(0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001,0.00001))\n\nsummary(model_REML_p)\n\n# and tidy up the results\nREML_params=data.frame(true=c(m=m,s=s,observed$p), estimate =c(coef(model_REML),coef(model_REML_p)), se = c(sqrt(diag(vcov(model_REML))),sqrt(diag(vcov(model_REML_p))))) |&gt;\n  mutate( z = (true-estimate)^2/se^2,\n          lower = estimate - 1.96*se,\n          upper = estimate + 1.96*se) |&gt;\n  rownames_to_column(var='param') |&gt;\n  select(param, everything()) |&gt; \n  mutate(param=factor(param,levels=c('m','s','p1','p2','p3','p4','p5','p6','p7','p8','p9','p10'))) |&gt;\n  mutate(level=factor(c('group_mean','group_dispersion',rep('trial',10)))) |&gt;\n  mutate(param_index = 1:12)\n\nREML_params\n\n##    param      true   estimate          se          z      lower      upper            level param_index\n## 1      m 0.3000000  0.3280964  0.03351673 0.70271450  0.2624036  0.3937892       group_mean           1\n## 2      s 8.0000000 23.1436114 12.56215846 1.45321669 -1.4782192 47.7654420 group_dispersion           2\n## 3     p1 0.2134503  0.2360292  0.03858028 0.34251204  0.1604119  0.3116466            trial           3\n## 4     p2 0.3254404  0.3350849  0.04288521 0.05057560  0.2510299  0.4191399            trial           4\n## 5     p3 0.2853022  0.2773025  0.04067250 0.03868527  0.1975843  0.3570206            trial           5\n## 6     p4 0.4947419  0.4506498  0.04520559 0.95134048  0.3620469  0.5392528            trial           6\n## 7     p5 0.3225656  0.2938117  0.04138481 0.48273865  0.2126975  0.3749259            trial           7\n## 8     p6 0.3637010  0.4589045  0.04527371 4.42194639  0.3701680  0.5476410            trial           8\n## 9     p7 0.2012123  0.2442839  0.03903654 1.21741661  0.1677723  0.3207956            trial           9\n## 10    p8 0.4527466  0.4258858  0.04492556 0.35748004  0.3378317  0.5139399            trial          10\n## 11    p9 0.1662158  0.1947565  0.03597917 0.62925532  0.1242373  0.2652756            trial          11\n## 12   p10 0.2363248  0.3350849  0.04288521 5.30331730  0.2510299  0.4191399            trial          12\n</code></pre>"},{"location":"blog/2025/03/17/hand-rolling-empirical-bayes-estimation-of-a-hierarchical-model-to-learn-how-it-works/#results","title":"Results","text":"<p>Now that we\u2019ve run both estimation processes, we can compare the results to each other and the underlying simulated truth.</p> <pre><code>ggplot() +\n  geom_point(data=full_lik_params,aes(x=param_index,y=estimate),color='red') +\n  geom_segment(data=full_lik_params,aes(x=param_index,y=lower,yend=upper,group=param),color='red') +\n  geom_point(data=REML_params,aes(x=param_index+0.1,y=estimate),color='blue') +\n  geom_segment(data=REML_params,aes(x=param_index+0.1,y=lower,yend=upper,group=param),color='blue') +\n  geom_point(data=full_lik_params,aes(x=param_index-0.1,y=true)) +\n  theme_bw()+\n  facet_wrap('level',scales='free') +\n  scale_x_continuous(breaks=seq(1:12),labels=levels(full_lik_params$param),minor_breaks = NULL) +\n  xlab('') +\n  geom_text(data=data.frame(param_index=rep(1.945,3),y=full_lik_params$upper[2]*c(0.95,0.85,0.75),label=c('truth','full likelihood','REML'),level=rep('group_dispersion',3)),\n            aes(x=param_index,y=y,label=label),color=c('black','red','blue'))\n</code></pre> <p></p> <p>In this example, the results are qualitatively similar.</p> <ul> <li> <p>Nominal 95% confidence interval coverage is acceptable for my     purposes for both,</p> <ul> <li>especially as Wald intervals are known to be too     narrow     and don\u2019t enforce that the dispersion hyperparameter must be     positive because I worked on the outcome scale and not the link     scale.</li> </ul> </li> <li> <p>The trial-level effect estimates and the group-level mean estimates     are nearly identical.</p> </li> <li> <p>The group-level dispersion parameter is biased high with the full     likelihood vs the REML estimate, as expected from the stats theory,     and in this case a bit wider.</p> </li> </ul>"},{"location":"blog/2025/03/17/hand-rolling-empirical-bayes-estimation-of-a-hierarchical-model-to-learn-how-it-works/#my-take-away","title":"My take-away","text":"<p>The most interesting parameters for the analogous problem in the immunity modeling building to come are the group-level mean and trial-level individual effects, both of which are estimated with similar quality regardless of the method. The group-level dispersion is the least relevant parameter for that activity, and so I take away that I\u2019m probably fine to do whatever is easiest to implement.</p> <p>And regardless, this will be a great place to engage with some peer review after the model is prototyped, so that we can do better if needed.</p> <p>Thanks for reading!</p>"},{"location":"docs/overview/","title":"Overview","text":"<p>This Docs section contains stand-alone documentation of the science and software supporting IDM's new typhoid immunity model. </p> <p>All data, code, writing, and results associated with this project are available on Github at famulare/typhoid-immune-dynamics.</p> <p>Major components include:</p> <ul> <li> <p>Literature Review to describe the questions we want the model to help answer and data required to fit the model.</p> </li> <li> <p>Descriptions of the Model Architecture that document the mathematics and software design.</p> </li> <li> <p>Calibration to estimate model parameters from data.</p> </li> <li> <p>Model Diagnostics to quantify goodness of fit and identify issues with the model, data, or both.</p> </li> <li> <p>and Doing Science with the model.</p> </li> </ul> <p>Click through the menu for the content.</p> <p>The Blog exists share musings, work in progress, etc that complement these Docs.</p>"},{"location":"docs/Literature%20Review/typhoid-vaccine-efficacy/","title":"Typhoid Conjugate Vaccine Efficacy (DRAFT)","text":"<p>Work in progress. Notes.</p>"},{"location":"docs/Literature%20Review/typhoid-vaccine-efficacy/#efficacy-and-immunogenicity-data","title":"Efficacy and immunogenicity data","text":"<p>Efficacy and immunogenecity data digitized at famulare/typhoid-immune-dynamics/data/typhoid_vaccine_efficacy.xlsx.</p>"},{"location":"docs/Literature%20Review/typhoid-vaccine-efficacy/#efficacy-papers-included-so-far","title":"Efficacy Papers included so far:","text":"<ul> <li> <p>Protection by vaccination of children against typhoid fever with a Vi-tetanus toxoid conjugate vaccine in urban Bangladesh: a cluster-randomised trial. Qadri F, Khanam F, Liu X, Theiss-Nyland K, Biswas PK, Bhuiyan AI, et al. Lancet. 2021 Aug 21;398(10301):675\u2013684. doi:10.1016/S0140-6736(21)01124-7. PMCID: PMC8387974. https://pmc.ncbi.nlm.nih.gov/articles/PMC8387974/</p> </li> <li> <p>5-year vaccine protection following a single dose of Vi-tetanus toxoid conjugate vaccine in Bangladeshi children (TyVOID): a cluster randomised trial. Qadri F, Khanam F, Zhang Y, Biswas PK, Voysey M, Mujadidi YF, et al. Lancet. 2024 Oct 12;404(10461):1419\u20131429. doi:10.1016/S0140-6736(24)01494-6. https://www.thelancet.com/journals/lancet/article/PIIS0140-6736(24)01494-6/fulltext</p> </li> <li> <p>Efficacy and immunogenicity of a Vi-tetanus toxoid conjugate vaccine in the prevention of typhoid fever using a controlled human infection model of Salmonella Typhi: a randomised controlled, phase 2b trial. Jin C, Gibani MM, Moore M, Juel HB, Jones E, Meiring J, et al. Lancet. 2017 Dec 2;390(10111):2472\u20132480. doi:10.1016/S0140-6736(17)32149-9. PMCID: PMC5720597. https://pmc.ncbi.nlm.nih.gov/articles/PMC5720597/</p> </li> <li> <p>Efficacy of Typhoid Conjugate Vaccine in Nepal: An Interim Analysis of a Participant-and Observer-Blinded Randomized Phase III Trial. Shakya M, Colin-Jones R, Theiss-Nyland K, Voysey M, Pant D, Smith N, et al. N Engl J Med. 2019 Dec 5;381(23):2209\u20132218. doi:10.1056/NEJMoa1905047. PMCID: PMC6785806. https://pmc.ncbi.nlm.nih.gov/articles/PMC6785806/</p> </li> <li> <p>Efficacy of typhoid conjugate vaccine in Nepal: final results of a phase 3, randomised, controlled trial. Shakya M, Voysey M, Theiss-Nyland K, Colin-Jones R, Pant D, Adhikari A, et al. Lancet Glob Health. 2021 Nov;9(11):e1561\u2013e1568. doi:10.1016/S2214-109X(21)00346-6. https://www.thelancet.com/journals/langlo/article/PIIS2214-109X(21)00346-6/fulltext</p> </li> <li> <p>Safety and Efficacy of a Typhoid Conjugate Vaccine in Malawian Children. Patel PDP, Patel P, Liang Y, Meiring JE, Misiri T, Mwakiseghile F, et al. N Engl J Med. 2021 Sep 16;385(12):1104\u20131115. doi:10.1056/NEJMoa2035916. PMCID: PMC8202713. https://pmc.ncbi.nlm.nih.gov/articles/PMC8202713/</p> </li> <li> <p>Efficacy of typhoid conjugate vaccine: final analysis of a 4-year, phase 3, randomised controlled trial in Malawian children. Patel PDP, Liang Y, Meiring JE, Chasweka N, Patel P, Misiri T, et al. Lancet. 2024 Feb 03;403(10425):459\u2013468. doi:10.1016/S0140-6736(23)02031-7.</p> </li> </ul>"},{"location":"docs/Literature%20Review/typhoid-vaccine-efficacy/#immunogenicity-papers-included-so-far","title":"Immunogenicity papers included so far","text":"<ul> <li> <p>Protection by vaccination of children against typhoid fever with a Vi-tetanus toxoid conjugate vaccine in urban Bangladesh: a cluster-randomised trial. Qadri F, Khanam F, Liu X, Theiss-Nyland K, Biswas PK, Bhuiyan AI, et al. Lancet. 2021 Aug 21;398(10301):675\u2013684. doi:10.1016/S0140-6736(21)01124-7. PMCID: PMC8387974. https://pmc.ncbi.nlm.nih.gov/articles/PMC8387974/</p> </li> <li> <p>5-year vaccine protection following a single dose of Vi-tetanus toxoid conjugate vaccine in Bangladeshi children (TyVOID): a cluster randomised trial. Qadri F, Khanam F, Zhang Y, Biswas PK, Voysey M, Mujadidi YF, et al. Lancet. 2024 Oct 12;404(10461):1419\u20131429. doi:10.1016/S0140-6736(24)01494-6. https://www.thelancet.com/journals/lancet/article/PIIS0140-6736(24)01494-6/fulltext</p> </li> <li> <p>Nampota\u2010Nkomba N, Nyirenda OM, Khonde L, Mapemba V, Mbewe M, Ndaferankhande JM, et al. Safety and immunogenicity of a typhoid conjugate vaccine among children aged 9 months to 12 years in Malawi: a nested substudy of a double\u2010blind, randomised controlled trial. Lancet Glob Health. 2022;10(9):e1326\u2013e1335. doi:10.1016/S2214-109X(22)00275-3. https://www.thelancet.com/journals/langlo/article/PIIS2214-109X(22)00275-3/fulltext</p> </li> <li> <p>Efficacy and immunogenicity of a Vi-tetanus toxoid conjugate vaccine in the prevention of typhoid fever using a controlled human infection model of Salmonella Typhi: a randomised controlled, phase 2b trial. Jin C, Gibani MM, Moore M, Juel HB, Jones E, Meiring J, et al. Lancet. 2017 Dec 2;390(10111):2472\u20132480. doi:10.1016/S0140-6736(17)32149-9. PMCID: PMC5720597. https://pmc.ncbi.nlm.nih.gov/articles/PMC5720597/</p> </li> <li> <p>Efficacy of typhoid conjugate vaccine in Nepal: final results of a phase 3, randomised, controlled trial. Shakya M, Voysey M, Theiss-Nyland K, Colin-Jones R, Pant D, Adhikari A, et al. Lancet Glob Health. 2021 Nov;9(11):e1561\u2013e1568. doi:10.1016/S2214-109X(21)00346-6. https://www.thelancet.com/journals/langlo/article/PIIS2214-109X(21)00346-6/fulltext</p> </li> </ul>"},{"location":"docs/Literature%20Review/typhoid-vaccine-efficacy/#articles-to-be-added","title":"Articles to be added","text":"<p>These either use different ELISA assays than the more modern papers and so need to be normalized, or are about vaccines not currently in common usage in LMICs.</p> <ul> <li> <p>Khan MI, Soofi SB, Ochiai RL, Habib MA, Sahito SM, Nizami SQ, et al. Effectiveness of Vi capsular polysaccharide typhoid vaccine among children: A cluster randomized trial in Karachi, Pakistan. Vaccine. 2012;30(36):5389\u20135395. doi:10.1016/j.vaccine.2012.06.015. https://www.sciencedirect.com/science/article/abs/pii/S0264410X12008560</p> </li> <li> <p>Sur D, Ochiai RL, Bhattacharya SK, Ganguly NK, Ali M, Manna B, et al. A cluster-randomized effectiveness trial of Vi typhoid vaccine in India. N Engl J Med. 2009 Jul 23;361(4):335\u201344. doi:10.1056/NEJMoa0807521. PMID: 19625715 https://pubmed.ncbi.nlm.nih.gov/19625715/</p> </li> <li> <p>Mitra M, Shah N, Ghosh A, Chatterjee S, Kaur I, Bhattacharya N, et al. Efficacy and safety of Vi-tetanus toxoid conjugated typhoid vaccine (PedaTyph\u2122) in Indian children: School based cluster randomized study. Hum Vaccin Immunother. 2016 Feb 22;12(4):939\u201345. doi:10.1080/21645515.2015.1117715. PMCID: PMC4962969 https://pmc.ncbi.nlm.nih.gov/articles/PMC4962969/</p> </li> <li> <p>Parry CM, Thieu NT, Farrar JJ, et al. Azithromycin versus ceftriaxone for the treatment of uncomplicated typhoid fever in Vietnamese children. N Engl J Med. 2001 Apr 26;344(17):1275\u201379. doi:10.1056/NEJM200104263441701 https://www.nejm.org/doi/10.1056/NEJM200104263441701?url_ver=Z39.88-2003&amp;rfr_id=ori:rid:crossref.org&amp;rfr_dat=cr_pub%20%200www.ncbi.nlm.nih.gov</p> </li> <li> <p>Kossaczka Z, Lin FYC, Ho VA, et al. Safety and immunogenicity of Vi conjugate vaccines for typhoid fever in adults, teenagers, and 2- to 4-year-old children in Vietnam. Infect Immun. 1999 Nov;67(11):5806\u201310. doi:10.1128/iai.67.11.5806-5810.1999. PMCID: PMC96958; PMID: 10531232 https://pmc.ncbi.nlm.nih.gov/articles/PMC96958/</p> </li> <li> <p>Kraay ANM, Yousafzai MT, Qureshi S, Gauld J, Qamar FN. Modeling the drivers of differential Typhoid Conjugate Vaccine (TCV) impact in Pakistan: force of infection and age-specific duration of protection [preprint]. medRxiv. 2024 Aug 30:2024.08.30.24312839. doi:10.1101/2024.08.30.24312839 https://www.medrxiv.org/content/10.1101/2024.08.30.24312839v1.full</p> </li> <li> <p>Lee EY, Park JY, Kim DR, Song M, Sahastrabuddhe S, Kim H, Chon Y, Yang JS. Comparison of anti-Vi IgG responses between two clinical studies of typhoid Vi conjugate vaccines (Vi-DT vs Vi-TT). PLoS Negl Trop Dis. 2020 Mar 23;14(3):e0008171. doi: 10.1371/journal.pntd.0008171. PMID: 32203521; PMCID: PMC7156108. https://pmc.ncbi.nlm.nih.gov/articles/PMC7156108/</p> </li> <li> <p>Syed KA, Saluja T, Cho H, Hsiao A, Shaikh H, Wartel TA, Mogasale V, Lynch J, Kim JH, Excler JL, Sahastrabuddhe S. Review on the recent advances on typhoid vaccine development and challenges ahead. Clin Infect Dis. 2020 Jul 29;71(Suppl 2):S141\u2013S150. doi: 10.1093/cid/ciaa504. PMID: 32725225; PMCID: PMC7388714. Note: thorough review with many references to consider.</p> </li> </ul>"},{"location":"docs/Model%20Architecture/Immune-model-mathematical-description/","title":"Immunity Model: Mathematical Description","text":""},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/category/immunity-model/","title":"Immunity model","text":""},{"location":"blog/category/intrahost-model/","title":"Intrahost model","text":""},{"location":"blog/category/software-architecture/","title":"Software architecture","text":""},{"location":"blog/category/project-management/","title":"Project Management","text":""},{"location":"blog/category/calibration/","title":"Calibration","text":""},{"location":"blog/category/self-study/","title":"Self-study","text":""}]}